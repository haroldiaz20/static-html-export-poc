(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{2008:function(e,t,n){__NEXT_REGISTER_PAGE("/command/kelleguides/goals",function(){return e.exports=n(2009),{page:e.exports.default}})},2009:function(e,t,n){"use strict";n.r(t);var r=n(6),o=n.n(r),a=n(0),c=n.n(a),s=n(1439),i=n(25),u=n(8),l=n(21),f=n.n(l),d=n(13),p=n(23),g=n(15),_=n(27),v=n(513),b=n(522);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t,n,r,o,a,c){try{var s=e[a](c),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(r,o)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w=[{header:"Set your goals.",image:c.a.createElement("img",{src:"https://kw-sites.s3-us-west-2.amazonaws.com/kw-images-prod/s3fs-public/img_goals.svg",alt:"Set your goals",height:"100%",width:"auto"}),content:"Fund the life you want. Define the specific actions you'll need to take this year to make it a reality."},{header:"Review your goals.",image:c.a.createElement("img",{height:"100%",width:"auto",src:"https://kw-sites.s3-us-west-2.amazonaws.com/kw-images-prod/s3fs-public/review-confirm.svg",alt:"Review your goals"}),content:"Double check your plan. If the math checks out, you're ready to take the next step."}],E=function(e){function t(){var e,n,r,a,c,s,i,u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,d=new Array(l),p=0;p<l;p++)d[p]=arguments[p];return r=this,a=(e=O(t)).call.apply(e,[this].concat(d)),n=!a||"object"!==m(a)&&"function"!=typeof a?S(r):a,s=S(n),i="componentDidMount",c=o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.a.router.pathname,e.next=3,n.props.findCurrentKelleGuideStep(t);case 3:n.props.setCurrentStepInProgress(n.props.currentStep);case 4:case"end":return e.stop()}},e)}),u=function(){var e=this,t=arguments;return new Promise(function(n,r){var o=c.apply(e,t);function a(e){y(o,n,r,a,s,"next",e)}function s(e){y(o,n,r,a,s,"throw",e)}a(void 0)})},i in s?Object.defineProperty(s,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[i]=u,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,c.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.steps,n=e.currentStep,r=t.length?t[0].url:null;return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.x,{title:p.o,subtitle:p.n,closeUrl:"/command/report-dashboard/goals"}),c.a.createElement(d.D,{items:t,currentStep:n,isValid:!0,validateStep:function(){return!0}}),c.a.createElement(d.w,{url:r,buttonMessage:"Get Started!",title:"What should I expect to get out of this guide?",subtitle:"Drive your business forward. Set goals that move the needle and plan your trajectory.",steps:w}))}}])&&h(n.prototype,r),a&&h(n,a),t}(),k=Object(u.b)({currentStep:Object(_.a)(),steps:Object(_.c)(),isValid:Object(_.b)(),attributes:Object(b.c)()});t.default=Object(i.b)(k,{setCurrentStep:g.d,setCurrentKelleGuide:g.c,setCurrentStepInProgress:g.e,findCurrentKelleGuideStep:g.a,validateEmailMarketing:g.f,getGoalsDefault:v.c})(Object(l.withRouter)(Object(s.c)(E)))},34:function(e,t,n){"use strict";n.d(t,"h",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"j",function(){return s}),n.d(t,"g",function(){return i}),n.d(t,"k",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"e",function(){return f}),n.d(t,"f",function(){return d}),n.d(t,"i",function(){return p}),n.d(t,"c",function(){return g});var r="ui-command-kelleguides/src/modules/Goals/",o="".concat(r,"UPDATE_CONVERSION_RATES_LIST"),a="".concat(r,"FETCHING_GOALS"),c="".concat(r,"FETCH_GOALS_SUCCESS"),s="".concat(r,"UPDATE_GOAL_FIELD"),i="".concat(r,"UPDATE_ATTRIBUTES"),u="".concat(r,"UPDATE_SHOULD_FETCH_DEFAULTS"),l="".concat(r,"SET_CURRENT_PROFIT_YEAR"),f="".concat(r,"SET_SHOW_YTD_INPUT"),d="".concat(r,"SET_USER_HAS_GOALS"),p="".concat(r,"UPDATE_GOALS_CONVERSION_RATES_LIST"),g="pno/api/v2"},513:function(e,t,n){"use strict";n.d(t,"h",function(){return u}),n.d(t,"e",function(){return l}),n.d(t,"c",function(){return f}),n.d(t,"f",function(){return d}),n.d(t,"g",function(){return p}),n.d(t,"b",function(){return g}),n.d(t,"d",function(){return _}),n.d(t,"k",function(){return v}),n.d(t,"i",function(){return y}),n.d(t,"l",function(){return h}),n.d(t,"j",function(){return S}),n.d(t,"m",function(){return j}),n.d(t,"a",function(){return w});var r=n(3),o=n(7),a=n(34);function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){s(e,t,n[t])})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){return{type:a.h,data:e}}var u=function(e,t){return function(n,r){var o=r().toJS().goalsReducer.conversionRatesList.map(function(n,r){return n.id===e&&(n.value=String(t).replace("%","")),n}),a=String(t).replace("%","");a=parseFloat(a)/100,a=Math.round(100*a)/100,n(y(e,a)),n(i(o))}},l=function(e){return function(t,n){var a=r.g.startAsyncSpan("getcurrentGoals"),s=n().toJS().goalsReducer.conversionRatesList,u=Object(r.e)("user_details").kwuid;if(e){var l="/goals/all?type=agent&id=".concat(u,"&year=").concat(parseInt(e,10));return r.c.get(l).then(function(e){r.g.finishAsyncSpanSuccess(a,e);var n=e.data.data;if(n){var u=n.items,l=n.gci;if(!(u&&u.seller&&l))throw new Error("Couldn't find default values.");var f={avg_unit_price:Object(o.get)(u.seller,"avg_unit_price",0),business_makeup:{seller:Object(o.get)(u.seller,"business_makeup",0),buyer:Object(o.get)(u.buyer,"business_makeup",0),lease:Object(o.get)(u.lease,"business_makeup",0)},avg_commission_amt:{seller:Object(o.get)(u.seller,"avg_commission_amt",0),buyer:Object(o.get)(u.buyer,"avg_commission_amt",0),lease:Object(o.get)(u.lease,"avg_commission_amt",0)},conversion_activity_to_lead:Object(o.get)(u.seller,"leads.conversion",0),conversion_agreement_to_under_contract:Object(o.get)(u.seller,"under_contract.conversion",0),conversion_contact_to_set:Object(o.get)(u.seller,"appointment_set.conversion",0),conversion_kept_to_agreement:Object(o.get)(u.seller,"agreements.conversion",0),conversion_lead_to_contact:Object(o.get)(u.seller,"contacts.conversion",0),conversion_set_to_kept:Object(o.get)(u.seller,"appointment_kept.conversion",0),conversion_under_contract_to_closed:Object(o.get)(u.seller,"closed_units.conversion",0),estimated_cost_of_sales:Object(o.get)(l,"estimated_cost_of_sales",0),expense_lead_generation:0,expense_operating:Object(o.get)(l,"estimated_expense",0),expense_salaries:0,conversion_agreement_to_pending:Object(o.get)(u.lease,"agreements.conversion",.75),conversion_pending_to_closed:Object(o.get)(u.lease,"pending.conversion",.75),profit:Object(o.get)(l,"profit",0),year:Object(o.get)(l,"year",0),ytd_sales:Object(o.get)(l,"ytd_sales",0)};t(O(f));var d=s.map(function(e,t){var n=c({},e),r=100*parseFloat(f[e.id]),o=Math.round(100*r)/100;return n.value=o,n});t(i(d)),t(v(!1))}return n}).catch(function(e){r.g.finishAsyncSpanError(a,e);var t=e.response,n=t.status,o=t.data.data,c=e.message;throw 400===n&&(c=o&&o.message),new Error(c)})}}},f=function(){return function(e,t){var n=r.g.startAsyncSpan("getGoalsDefault"),o=t().toJS().goalsReducer,a=o.conversionRatesList;if(o.shouldFetchDefaults){return r.c.get("/goals/default/all").then(function(t){r.g.finishAsyncSpanSuccess(n,t);var o=t.data.data;if(o){var s=o.attributes;if(s){e(O(s));var u=a.map(function(e,t){var n=c({},e),r=100*parseFloat(s[e.id]);return n.value=r,n});e(i(u)),e(v(!1))}}return!0}).catch(function(e){return r.g.finishAsyncSpanError(n,e),e})}}},d=function(){return function(e,t){var n=r.g.startAsyncSpan("saveConversionRateGoal"),o={data:{attributes:c({},{domain_id:Object(r.e)("user_details").kwuid,domain_type:"agent"},t().toJS().goalsReducer.attributes)}};return r.c.post("/goals/all",o).then(function(e){return r.g.finishAsyncSpanSuccess(n,e),e.data}).catch(function(e){r.g.finishAsyncSpanError(n,e);var t=e.response,o=e.message;throw t&&422===t.status&&(o="Please enter a valid percentage number for each conversion rate."),new Error(o)})}},p=function(e){return function(t,n){var o=r.g.startAsyncSpan("saveGoalsForSelectedYear"),a=Object(r.e)("user_details").kwuid,s={data:{attributes:c({},n().toJS().goalsReducer.attributes,{domain_id:a,domain_type:"agent",year:e})}};return r.c.post("/goals/all",s).then(function(e){return r.g.finishAsyncSpanSuccess(o,e),e.data}).catch(function(e){r.g.finishAsyncSpanError(o,e);var t=e.response,n=e.message;throw t&&422===t.status&&(n="Please enter a valid percentage number for each conversion rate."),new Error(n)})}},g=function(){return function(e){e(b());var t=r.g.startAsyncSpan("fetchGoals"),n=Object(r.e)("user_details").kwuid,o="goals?type=agent&id=".concat(n);return r.c.get(o).then(function(n){return r.g.finishAsyncSpanSuccess(t,n),e(m()),e(y(n.data.data)),n.data.data}).catch(function(n){throw r.g.finishAsyncSpanError(t,n),e(b()),new Error("We could not fetch goals")})}},_=function(){return function(e,t){var n=Object(r.e)("user_details").kwuid;if(n){var o="".concat(a.c,"/people/").concat(n),c=r.g.startAsyncSpan("getPeopleInOrgData");return r.c.get(o).then(function(e){return r.g.finishAsyncSpanSuccess(c,e),e.data}).catch(function(e){throw r.g.finishAsyncSpanError(c,e),new Error(e)})}}},v=function(e){return{type:a.k,data:e}},b=function(){return{type:a.a}},m=function(){return{type:a.b}},y=function(e,t){return{type:a.j,itemKey:e,itemData:t}},h=function(e){return{type:a.e,data:e}},O=function(e){return{type:a.g,data:e}},S=function(e){return{type:a.d,data:e}},j=function(e){return function(t,n){t(function(e){return{type:a.f,data:e}}(e))}},w=function(){return function(e,t){var n=r.g.startAsyncSpan("calculateGoals"),s=Object(r.e)("user_details").kwuid,u=t().toJS().goalsReducer,l=u.attributes,f=u.conversionRatesList,d={data:{attributes:c({},{domain_id:s,domain_type:"agent"},l)}};return r.c.post("/goals/calculate/all",d).then(function(t){r.g.finishAsyncSpanSuccess(n,t);var s,u=t.data.data;if(u){var l=u.items,d=u.gci;if(!(l&&l.seller&&d))throw new Error("Couldn't find default values.");e((s=l.seller,{type:a.i,data:s}));var p=Object(o.get)(l.seller,"business_makeup",0),g={avg_commission_amt:Object(o.get)(l.seller,"avg_commission_amt",0),avg_unit_price:Object(o.get)(l.seller,"avg_unit_price",0),business_makeup:{seller:p,buyer:1-p},conversion_activity_to_lead:Object(o.get)(l.seller,"leads.conversion",0),conversion_agreement_to_under_contract:Object(o.get)(l.seller,"under_contract.conversion",0),agreements:Object(o.get)(l.seller,"agreements.conversion",0),conversion_contact_to_set:Object(o.get)(l.seller,"appointment_set.conversion",0),conversion_kept_to_agreement:Object(o.get)(l.seller,"agreements.conversion",0),conversion_lead_to_contact:Object(o.get)(l.seller,"contacts.conversion",0),conversion_set_to_kept:Object(o.get)(l.seller,"appointment_kept.conversion",0),conversion_under_contract_to_closed:Object(o.get)(l.seller,"closed_units.conversion",0),estimated_cost_of_sales:Object(o.get)(d,"estimated_cost_of_sales",0),expense_lead_generation:0,expense_operating:Object(o.get)(d,"estimated_expense",0),expense_salaries:0,profit:Object(o.get)(d,"profit",0),year:Object(o.get)(d,"year",0),ytd_sales:Object(o.get)(d,"ytd_sales",0)};e(O(g));var _=f.map(function(e,t){var n=c({},e),r=100*parseFloat(g[e.id]);return n.value=r,n});e(i(_)),e(v(!1))}return u}).catch(function(e){throw new Error("We could not calculate your goals")})}}},522:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"e",function(){return s}),n.d(t,"d",function(){return i});var r=n(8),o=function(){return function(e){return e.get("goalsReducer").toJS()}},a=function(){return Object(r.a)(function(e){return e.get("goalsReducer")},function(e){var t=e.get("conversionRatesList");return t&&!1!==t.__altered?t:t.toJS()})},c=function(){return Object(r.a)(function(e){return e.get("goalsReducer")},function(e){var t=e.get("attributes");return t&&!1!==t.__altered?t:t.toJS()})},s=function(){return Object(r.a)(function(e){return e.get("goalsReducer")},function(e){var t=e.get("attributes");return(t&&!1!==t.__altered?t:t.toJS()).profit})},i=function(){return Object(r.a)(function(e){return e.get("goalsReducer")},function(e){var t=e.get("goalsConversionList");return t&&!1!==t.__altered?t:t.toJS()})}}},[[2008,1,0,2]]]);